<script>
// ========== Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© (ØªØ£ÙƒØ¯ Ù…Ù† Ù…Ø·Ø§Ø¨Ù‚ØªÙ‡Ø§ Ù„Ù„ØªØµÙ…ÙŠÙ…) ==========
let score = parseInt(localStorage.getItem('score')) || 0;
let energy = parseInt(localStorage.getItem('energy')) || 1000; // ØªÙ… Ø±ÙØ¹Ù‡Ø§ Ù„Ù€ 1000 Ù„ØªÙ†Ø§Ø³Ø¨ Ø§Ù„Ø¨ÙˆØªØ§Øª Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠØ©
let refCount = parseInt(localStorage.getItem('refCount')) || 0;
const MAX_ENERGY = 1000;

// ========== Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„ÙÙˆØ±ÙŠ Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„ ==========
document.addEventListener('DOMContentLoaded', () => {
    console.log("ğŸš€ ØªÙ… ØªØ´ØºÙŠÙ„ Ù†Ø¸Ø§Ù… Bitco93 Pro");
    
    // 1. ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
    updateUI();
    initNavigation();
    initTapCoin();
    createWheel();
    
    // 2. Ø¥Ø®ÙØ§Ø¡ Ø´Ø§Ø´Ø© Ø§Ù„ØªØ±Ø­ÙŠØ¨
    const welcome = document.getElementById('welcome');
    if(welcome) {
        setTimeout(() => welcome.style.display = 'none', 2500);
    }

    // 3. Ù†Ø¸Ø§Ù… Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø·Ø§Ù‚Ø© Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
    setInterval(() => {
        if (energy < MAX_ENERGY) {
            energy += 2;
            updateUI();
            localStorage.setItem('energy', energy);
        }
    }, 2000);
});

// ========== Ù†Ø¸Ø§Ù… Ø§Ù„ØªÙ†Ù‚Ù„ Ø¨ÙŠÙ† Ø§Ù„Ø®Ø§Ù†Ø§Øª (Ø¥ØµÙ„Ø§Ø­ Ø´Ø§Ù…Ù„) ==========
function initNavigation() {
    const navButtons = document.querySelectorAll('.nav-btn');
    const tabContents = document.querySelectorAll('.tab-content');

    navButtons.forEach(btn => {
        btn.onclick = (e) => {
            const tabId = btn.getAttribute('data-tab');
            
            // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„ÙƒÙ„
            tabContents.forEach(tab => {
                tab.style.display = 'none';
                tab.classList.remove('active');
            });
            
            // Ø¥Ù„ØºØ§Ø¡ ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø£Ø²Ø±Ø§Ø±
            navButtons.forEach(b => b.classList.remove('active'));
            
            // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©
            const target = document.getElementById(tabId);
            if(target) {
                target.style.display = 'block';
                target.classList.add('active');
                btn.classList.add('active');
                console.log("âœ… ØªÙ… ÙØªØ­ Ø®Ø§Ù†Ø©: " + tabId);
            }
        };
    });
}

// ========== Ù†Ø¸Ø§Ù… Ø§Ù„Ù†Ù‚Ø± (Ù…Ø«Ù„ Ù‡Ø§Ù…Ø³ØªØ±) ==========
function initTapCoin() {
    const tapCoin = document.getElementById('tapCoin');
    if(!tapCoin) return;

    tapCoin.addEventListener('click', (e) => {
        if (energy > 0) {
            score += 1;
            energy -= 1;
            
            updateUI();
            saveData();
            
            // ØªØ£Ø«ÙŠØ±Ø§Øª Ø¨ØµØ±ÙŠØ©
            createFloatingNumber(e);
            tapCoin.style.transform = 'scale(0.92)';
            setTimeout(() => tapCoin.style.transform = 'scale(1)', 100);
        } else {
            showNotification('âš¡ Ø·Ø§Ù‚Ø© Ù…Ù†Ø®ÙØ¶Ø© Ø¬Ø¯Ø§Ù‹!');
        }
    });
}

// ========== ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… (UI) ==========
function updateUI() {
    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£Ø±Ù‚Ø§Ù… ÙÙŠ ÙƒÙ„ Ù…ÙƒØ§Ù†
    const elements = {
        'score': score.toLocaleString(),
        'energy': energy,
        'refCount': refCount,
        'spinsLeft': refCount // Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ø§Ù„Ø¥Ø­Ø§Ù„Ø§Øª
    };

    for (let id in elements) {
        const el = document.getElementById(id);
        if(el) el.textContent = elements[id];
    }

    // ØªØ­Ø¯ÙŠØ« Ø´Ø±ÙŠØ· Ø§Ù„Ø¨Ø·Ø§Ø±ÙŠØ©
    const batteryFill = document.getElementById('batteryFill');
    if(batteryFill) {
        const percent = (energy / MAX_ENERGY) * 100;
        batteryFill.style.width = percent + '%';
    }

    // ØªÙØ¹ÙŠÙ„/ØªØ¹Ø·ÙŠÙ„ Ø²Ø± Ø§Ù„Ø¹Ø¬Ù„Ø©
    const spinBtn = document.getElementById('spinBtn');
    if(spinBtn) spinBtn.disabled = (refCount <= 0);
}

// ========== Ù†Ø¸Ø§Ù… Ø¹Ø¬Ù„Ø© Ø§Ù„Ø­Ø¸ (Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ø¯ÙˆØ±Ø§Ù†) ==========
function createWheel() {
    const wheel = document.getElementById('wheel');
    if(!wheel) return;
    
    wheel.innerHTML = '';
    const rewards = [100, 500, 10, 50, "Ø­Ø¸ Ø£ÙˆÙØ±", 1000, 5, 200];
    
    rewards.forEach((text, i) => {
        const seg = document.createElement('div');
        seg.className = 'wheel-number';
        seg.style.transform = `translateX(-50%) rotate(${i * 45}deg)`;
        seg.textContent = text;
        wheel.appendChild(seg);
    });
}

function startSpin() {
    if(refCount <= 0) return;

    const wheel = document.getElementById('wheel');
    refCount--;
    saveData();
    updateUI();

    const randomDeg = Math.floor(3000 + Math.random() * 3000);
    wheel.style.transition = 'transform 4s cubic-bezier(0.1, 0, 0.1, 1)';
    wheel.style.transform = `rotate(${randomDeg}deg)`;

    setTimeout(() => {
        showNotification('ğŸ‰ Ù…Ø¨Ø±ÙˆÙƒ! Ø­ØµÙ„Øª Ø¹Ù„Ù‰ Ù…ÙƒØ§ÙØ£Ø© Ø§Ù„Ø¹Ø¬Ù„Ø©');
        score += 100; // Ù…ÙƒØ§ÙØ£Ø© Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
        updateUI();
    }, 4000);
}

// ========== ÙˆØ¸Ø§Ø¦Ù Ù…Ø³Ø§Ø¹Ø¯Ø© ==========
function saveData() {
    localStorage.setItem('score', score);
    localStorage.setItem('energy', energy);
    localStorage.setItem('refCount', refCount);
}

function createFloatingNumber(e) {
    const num = document.createElement('div');
    num.textContent = '+1';
    num.className = 'tap-effect'; // ØªØ£ÙƒØ¯ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„Ù€ CSS Ø§Ù„Ø®Ø§Øµ Ø¨Ù‡Ø§
    num.style.left = e.clientX + 'px';
    num.style.top = e.clientY + 'px';
    document.body.appendChild(num);
    setTimeout(() => num.remove(), 800);
}

function showNotification(msg) {
    const notify = document.getElementById('notification');
    if(notify) {
        notify.textContent = msg;
        notify.classList.add('show');
        setTimeout(() => notify.classList.remove('show'), 3000);
    }
}
</script>
